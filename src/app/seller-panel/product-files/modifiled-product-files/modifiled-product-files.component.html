<div class="container">
  <div class="heading mt-3 mb-3">
    <i class="bi bi-images"></i>
    Product Files
  </div>

  <button mat-raised-button color="primary" (click)="modelNewShow()" >Add New File</button>

  <table class="table table-sm table-hover table-bordered fs11 text-center">
    <thead>
      <tr style="background-color: #e7e8e8;">
        <th scope="col">S.No</th>
        <th scope="col"><i class="bi bi-images"></i> Preview</th>
        <th scope="col">File Type</th>
        <th scope="col">Action</th>
      </tr>
    </thead>

    <tbody>
      <tr *ngFor="let data of productData; let i = index">
        <td class="p-3">{{ i + 1 }}</td>

        <!-- IMAGE -->
        <td *ngIf="data.fileType === 'IMAGE'">
          <img
            [src]="data.fileUrl"
            height="65"
            width="65"
            class="p-1"
            style="border-radius: 8px; object-fit: cover; cursor: pointer;"
            alt="image"
            (click)="openImageModal(i)"
          />
        </td>

        <!-- VIDEO -->
        <td *ngIf="data.fileType === 'VIDEO'">
          <video
            [src]="data.fileUrl"
            height="100"
            width="200"
            class="p-1"
            style="border-radius: 8px; object-fit: cover;"
            controls
            preload="metadata"
          ></video>
        </td>

        <td>{{ data.fileType }}</td>

        <td>
          <button
            *ngIf="data.fileType === 'IMAGE'"
            class="small-btn product-files modified-files"
            mat-raised-button
            (click)="modifiedImageFile(i)"
          >
            <span class="fs11">Modified Files</span>
          </button>

          <button
            *ngIf="data.fileType === 'VIDEO'"
            class="small-btn product-files modified-files"
            mat-raised-button
            (click)="modifiedVideoFile(i)"
          >
            <span class="fs11">Modified Video</span>
          </button>
        </td>
      </tr>
    </tbody>
  </table>
</div>







 <!-- ###########################################################################################################################
 ########################################################################################################################### -->






<!-- =====================IMAGE MODIFIED MODAL========================= -->
<div
  class="modal fade"
  data-bs-backdrop="static"
  id="exampleModal"
  tabindex="-1"
  aria-labelledby="exampleModalLabel"
  aria-hidden="true"
  #modifiedImageModel
>
  <div class="modal-dialog modal-dialog-centered modal-lg">
    <div class="modal-content p-3">
      <div class="modal-body text-center">
        <div>
          <i class="bi bi-images" style="color: #2cff21;"></i>
          <span class="mx-2 fw-bold">Modified File</span>
        </div>

        <!-- Current Image Preview -->
        <div class="mt-3">
          <img
            *ngIf="selectedImageUrl"
            [src]="selectedImageUrl"
            height="50"
            width="50"
            class="border rounded"
            style="object-fit: cover;"
            alt="Current Image"
          />
        </div>

        <!-- Upload New File -->
        <div class="mt-3">
          <input
            type="file"
            accept="image/*"
            (change)="onFileSelected($event)"
            class="form-control w-50 mx-auto"
          />
        </div>

        <!-- Preview of Selected New Image -->
        <div class="mt-3" *ngIf="previewUrl">
          <p class="fs12 text-muted mb-1">New Image Preview:</p>
          <img
            [src]="previewUrl"
            height="50"
            width="50"
            class="border rounded"
            style="object-fit: cover;"
            alt="Preview Image"
          />
        </div>
      </div>

      <div class="mb-3 text-center">
        <button mat-raised-button class="me-2" data-bs-dismiss="modal">
          Close
        </button>
        <button
          mat-raised-button
          color="primary"
          (click)="updateFile()"
          [disabled]="!selectedFile"
        >
          Update File
        </button>
      </div>
    </div>
  </div>
</div>
<!-- =====================IMAGE MODIFIED MODAL END========================= -->






 <!-- ###########################################################################################################################
 ########################################################################################################################### -->







<!-- =====================VIDEO MODIFIED MODAL========================= -->
<div
  class="modal fade"
  data-bs-backdrop="static"
  id="videoModal"
  tabindex="-1"
  aria-labelledby="videoModalLabel"
  aria-hidden="true"
  #modifiedVideoModel
>
  <div class="modal-dialog modal-dialog-centered modal-lg">
    <div class="modal-content p-3">
      <div class="modal-body text-center">
        <div>
          <i class="bi bi-camera-reels" style="color: #007bff;"></i>
          <span class="mx-2 fw-bold">Modified Video</span>
        </div>

        <!-- Current Video Preview -->
        <div class="mt-3" *ngIf="selectedVideoUrl">
          <video
            [src]="selectedVideoUrl"
            height="120"
            width="200"
            class="border rounded"
            controls
          ></video>
        </div>

        <!-- Upload New Video -->
        <div class="mt-3">
          <input
            type="file"
            accept="video/*"
            (change)="onVideoSelected($event)"
            class="form-control w-50 mx-auto"
          />
        </div>

        <!-- Preview of Selected New Video -->
        <div class="mt-3" *ngIf="previewVideoUrl">
          <p class="fs12 text-muted mb-1">New Video Preview:</p>
          <video
            [src]="previewVideoUrl"
            height="120"
            width="200"
            class="border rounded"
            controls
          ></video>
        </div>
      </div>

      <div class="mb-3 text-center">
        <button mat-raised-button class="me-2" data-bs-dismiss="modal">
          Close
        </button>
        <button
          mat-raised-button
          color="primary"
          (click)="updateVideoFile()"
          [disabled]="!selectedVideoFile"
        >
          Update Video
        </button>
      </div>
    </div>
  </div>
</div>
<!-- =====================VIDEO MODIFIED MODAL END========================= -->



 <!-- ###########################################################################################################################
 ########################################################################################################################### -->





<!-- =====================NEW FILE UPLOAD MODAL========================= -->
<div
  class="modal fade"
  data-bs-backdrop="static"
  id="newFileModal"
  tabindex="-1"
  aria-labelledby="newFileModalLabel"
  aria-hidden="true"
  #newFileModel
>
  <div class="modal-dialog modal-dialog-centered modal-lg">
    <div class="modal-content p-3">
      <div class="modal-body text-center">
        <div>
          <i class="bi bi-cloud-upload" style="color: #0d6efd;"></i>
          <span class="mx-2 fw-bold">Upload New File</span>
        </div>

        <!-- Upload New File -->
        <div class="mt-3">
          <input
            type="file"
            accept="image/*,video/*"
            (change)="onNewFileSelected($event)"
            class="form-control w-50 mx-auto"
          />
        </div>

        <!-- Preview of Selected New File -->
        <div class="mt-3" *ngIf="newPreviewUrl">
          <p class="fs12 text-muted mb-1">Preview:</p>

          <!-- Show image -->
          <img
            *ngIf="newSelectedFileType === 'image'"
            [src]="newPreviewUrl"
            height="60"
            width="60"
            class="border rounded"
            style="object-fit: cover;"
            alt="Preview Image"
          />

          <!-- Show video -->
          <video
            *ngIf="newSelectedFileType === 'video'"
            [src]="newPreviewUrl"
            height="100"
            width="100"
            class="border rounded"
            controls
          ></video>
        </div>
      </div>

      <div class="mb-3 text-center">
        <button mat-raised-button class="me-2" data-bs-dismiss="modal">
          Close
        </button>
        <button
          mat-raised-button
          color="primary"
          (click)="uploadNewFile()"
          [disabled]="!newSelectedFile"
        >
          Upload File
        </button>
      </div>
    </div>
  </div>
</div>
<!-- =====================NEW FILE UPLOAD MODAL END========================= -->


 <!-- ###########################################################################################################################
 ########################################################################################################################### -->




























<!-- ðŸŸ¢ IMAGE PREVIEW MODAL WITH FIXED SIZE + NEXT/PREV -->
<div
  class="modal fade"
  id="imagePreviewModal"
  tabindex="-1"
  aria-labelledby="imagePreviewModalLabel"
  aria-hidden="true"
>
  <div class="modal-dialog modal-dialog-centered image-modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h6 class="modal-title" id="imagePreviewModalLabel">
          Image Preview ({{ currentIndex + 1 }}/{{ imageList.length }})
        </h6>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="modal"
          aria-label="Close"
        ></button>
      </div>

      <!-- ðŸŸ¢ FIXED HEIGHT BODY -->
      <div class="modal-body text-center position-relative image-modal-body">
        <!-- Image -->
        <img
          [src]="selectedImage"
          alt="Preview"
          class="rounded image-preview"
        />

        <!-- Prev Button -->
        <button
          class="btn btn-light position-absolute top-50 start-0 translate-middle-y nav-btn"
          (click)="prevImage()"
          [disabled]="currentIndex === 0"
        >
          <i class="bi bi-chevron-left fs-5"></i>
        </button>

        <!-- Next Button -->
        <button
          class="btn btn-light position-absolute top-50 end-0 translate-middle-y nav-btn"
          (click)="nextImage()"
          [disabled]="currentIndex === imageList.length - 1"
        >
          <i class="bi bi-chevron-right fs-5"></i>
        </button>
      </div>
    </div>
  </div>
</div>
